# 浏览器分页打印实现方案

## 1. 背景与目标
在多页单据打印场景中，为了提升可读性和专业性，必须确保：

*   **页头重复**：标题、基础信息等在每一页顶部重复显示。
*   **页尾重复**：签名栏、注意事项等在每一页底部重复显示。
*   **布局自适应**：内容能够根据纸张大小自动流式分页。

## 2. 核心技术方案：单一大表格 (Single Table)
### 2.1 方案原理
利用浏览器打印引擎对 HTML `<table>` 元素的标准分页处理机制：

*   `<thead>`：浏览器会自动尝试在每一页顶部重复表头。
*   `<tfoot>`：浏览器会自动尝试在每一页底部重复表尾。
*   `<tbody>`：作为表格主体，浏览器会根据页面高度自动进行分页切割。

**注意**：传统的“嵌套表格”方案（即 `thead` 中嵌套另一个 `table`）往往会被浏览器视作一个巨大的单行元素，导致无法正确分页或重复表头。因此，必须使用**扁平化的单一大表格结构**。

### 2.2 实现规范

#### (1) HTML 结构
将所有打印内容（标题、信息、数据、签名）统一放入一个 `<table>` 中。

```html
<table class="print-table-main">
  <!-- 页头区域：包含标题、业务基础信息 -->
  <thead>
    <!-- 标题行 -->
    <tr>
      <!-- 使用 colspan 跨越所有列，no-border 去除边框以模拟普通布局 -->
      <th colspan="9" class="no-border">
        <div class="header-section">
            <h1 class="print-title">单据标题</h1>
        </div>
      </th>
    </tr>
    <!-- 基础信息行 -->
    <tr>
      <th colspan="9" class="no-border">
        <div class="basic-info-section">
          <!-- 使用 flex 或 inline-block 布局基础信息 -->
          <div class="info-item"><span>项目1：</span>Content...</div>
          <div class="info-item"><span>项目2：</span>Content...</div>
        </div>
      </th>
    </tr>
    <!-- 数据列表的列名 -->
    <tr class="column-header">
      <th>序号</th>
      <th>名称</th>
      <!-- ...其他列 -->
    </tr>
  </thead>
  
  <!-- 数据主体 -->
  <tbody>
    <tr v-for="(item, index) in list" :key="index">
      <td>{{ index + 1 }}</td>
      <td>{{ item.name }}</td>
      <!-- ... -->
    </tr>
  </tbody>
  
  <!-- 页尾区域：包含签名、说明 -->
  <tfoot>
    <tr>
      <td colspan="9" class="no-border">
        <div class="footer-section">
          <div class="notes">注意事项：...</div>
          <div class="signatures">
            <span class="signature-item">制单人：_______</span>
            <span class="signature-item">审核人：_______</span>
          </div>
        </div>
      </td>
    </tr>
  </tfoot>
</table>
```

#### (2) 关键样式 (CSS)
```css
/* 强制浏览器重复表头和表尾 */
thead { display: table-header-group !important; }
tfoot { display: table-footer-group !important; }

/* 防止表格行在中间断开 */
tr { page-break-inside: avoid; break-inside: avoid; }

/* 确保边框清晰，解决分页处边框丢失问题 */
table { border-collapse: collapse !important; width: 100%; }

/* 模拟无边框布局：用于页头和页尾的单元格 */
.no-border {
  border: none !important;
  padding: 0 !important;
  text-align: left; 
}

/* 基础样式 (Screen & Print) */
.print-table-main {
  width: 100%;
  border-collapse: collapse;
}

.print-table-main th, 
.print-table-main td {
  border: 1px solid #000; /* 使用纯黑边框以获得最佳打印效果 */
  padding: 4px;
  font-size: 12px;
}

/* 页头布局 */
.header-section { text-align: center; margin-bottom: 10px; }
.basic-info-section { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 5px; }

/* 页尾布局 */
.footer-section { margin-top: 10px; }
.signatures { display: flex; justify-content: space-between; margin-top: 20px; }
```

## 3. 常见问题与排查 (Troubleshooting)

### 3.1 表头只在第一页显示？
*   **原因**：页头内容高度过高（超过页面高度的 25%），浏览器为了保证数据展示空间，会自动取消后续页面的表头重复。
*   **解决**：精简页头信息，减小字体，减少 padding/margin。

### 3.2 表格线在分页处断开或加粗？
*   **原因**：浏览器的渲染计算误差。
*   **解决**：确保 `border-collapse: collapse`；尝试设置 `tr { page-break-inside: avoid; }` 避免行内断开。

### 3.3 "Ghost Headers" (幽灵表头)？
*   **现象**：有时表头会在上一页底部重复出现。
*   **解决**：这通常是浏览器 bug。尝试给 `thead` 添加 `transform: translateZ(0)` 或调整表格结构。

## 4. 样式推荐
为保证打印输出的专业性和一致性，建议遵循以下样式：

| 属性 | 建议值 | 说明 |
| :--- | :--- | :--- |
| **字体颜色** | #000000 | 纯黑色 (Pure Black)，激光打印机效果最佳 |
| **表格边框** | 1px solid #000 | 细黑实线 |
| **表头背景** | transparent | 打印通常不推荐背景色，费墨且可能不清晰 |
| **字体** | "Microsoft YaHei", sans-serif | 确保中文显示清晰 |
| **字号** | 9pt - 10pt (12px-14px) | 正文合适大小，页头可稍大 |
